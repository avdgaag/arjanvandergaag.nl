<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<!--[if lt IE 7 ]> <html lang="nl" class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="nl" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="nl" class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="nl" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="nl"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">

        <title>Creating new Jekyll posts &bull; Arjan van der Gaag.nl</title>
        <meta name="keywords" content="">
        <meta name="description" content="">
        <meta name="copyright" content="">
        <meta name="author" content="">

        <meta name="robots" content="index, follow">

        <link rel="stylesheet" href="/assets/styles.css">
        <link href="/assets/favicon.png" rel="shortcut icon">

        <script>
            var _gaq = [['_setAccount', 'UA-XXXXX-X'], ['_trackPageview']];
            (function(d, t) {
                var g = d.createElement(t),
                    s = d.getElementsByTagName(t)[0];
                g.async = true;
                g.src = '//www.google-analytics.com/ga.js';
                s.parentNode.insertBefore(g, s);
            })(document, 'script');
        </script>
    </head>
    <body class="inside">

        <div id="page">

            <div id="header">

                <a href="/" title="Back to the front page" rel="home" accesskey="h" id="title">Arjan van der Gaag <small>.nl</small></a>

                <p>I’m <strong>Arjan van der Gaag</strong> and this is my website about me, code, food, photography and more. If you like, we can <a href="mailto:&#x61;&#x72;&#x6A;&#x61;&#x6E;&#x40;&#x61;&#x72;&#x6A;&#x61;&#x6E;&#x76;&#x61;&#x6E;&#x64;&#x65;&#x72;&#x67;&#x61;&#x61;&#x67;&#x2E;&#x6E;&#x6C;">get in touch</a>.</p>

                <hr>

            </div><!-- /header -->

            <div id="content">

                <h1>Creating new Jekyll posts</h1>
<p class="meta">
    Published at 16-06-2009 &bull;
    Tagged blog, blogging, website, meta, cms, writing, automation<br>
    Next: <a href="/blog/introducing-mutil.html">Introducing μtil</a>
    Previous: <a href="/blog/publishing-a-jekyll-website-to-a-server.html">Publishing a Jekyll website to a server</a>
</p>

<p class="leader">Jekyll, a static site generator, is <em>blog-aware</em>. That means it tracks posts
and publication dates. Working with such files can be tricky, but here is one
way of using Rake to ease the pain.</p>

<h2 id="what-we-need">What we need</h2>

<p>Jekyll requires blog posts to be saved in files with a specific filename. It
should include the title of the post <strong>and the publication date</strong>. Example:
2009-06-15-hello-world.markdown. The extension tells Jekyll what text filter
to use (Markdown in this case).</p>

<h2 id="what-we-want">What we want</h2>

<p>Manually typing filenames in the form <code>yyyy-mm-dd-title.filter</code> is a
pain. I want to be able to create a post, given a title, and let it figure out
the date itself.</p>

<h2 id="what-we-get">What we get</h2>

<p>I use the following Rake task to create post files:</p>

<pre><code class="language-ruby">desc <span class="s"><span class="dl">'</span><span class="k">create a new draft post</span><span class="dl">'</span></span>
task <span class="sy">:post</span> <span class="r">do</span>
  title = <span class="co">ENV</span>[<span class="s"><span class="dl">'</span><span class="k">TITLE</span><span class="dl">'</span></span>]
  slug = <span class="s"><span class="dl">"</span><span class="il"><span class="idl">#{</span><span class="co">Date</span>.today<span class="idl">}</span></span><span class="k">-</span><span class="il"><span class="idl">#{</span>title.downcase.gsub(<span class="rx"><span class="dl">/</span><span class="k">[^</span><span class="ch">\w</span><span class="k">]+</span><span class="dl">/</span></span>, <span class="s"><span class="dl">'</span><span class="k">-</span><span class="dl">'</span></span>)<span class="idl">}</span></span><span class="dl">"</span></span>

  file = <span class="co">File</span>.join(
    <span class="co">File</span>.dirname(<span class="pc">__FILE__</span>),
    <span class="s"><span class="dl">'</span><span class="k">_posts</span><span class="dl">'</span></span>,
    slug + <span class="s"><span class="dl">'</span><span class="k">.markdown</span><span class="dl">'</span></span>
  )

  <span class="co">File</span>.open(file, <span class="s"><span class="dl">"</span><span class="k">w</span><span class="dl">"</span></span>) <span class="r">do</span> |f|
    f &lt;&lt; <span class="s"><span class="dl">&lt;&lt;-EOS</span></span>.gsub(<span class="rx"><span class="dl">/</span><span class="k">^    </span><span class="dl">/</span></span>, <span class="s"><span class="dl">'</span><span class="dl">'</span></span>)<span class="s"><span class="k">
    ---
    layout: post
    title: </span><span class="il"><span class="idl">#{</span>title<span class="idl">}</span></span><span class="k">
    published: false
    categories:
    ---
</span><span class="dl">
    EOS</span></span>
  <span class="r">end</span>

  system (<span class="s"><span class="dl">"</span><span class="il"><span class="idl">#{</span><span class="co">ENV</span>[<span class="s"><span class="dl">'</span><span class="k">EDITOR</span><span class="dl">'</span></span>]<span class="idl">}</span></span><span class="k"> </span><span class="il"><span class="idl">#{</span>file<span class="idl">}</span></span><span class="dl">"</span></span>)
<span class="r">end</span></code></pre>

<p>Now I can type <code>rake post TITLE='hello, world'</code> to create a post. Here’s what
it does:</p>

<ol>
<li>At lines 3 and 4 it finds the <code>TITLE</code> argument and converts it to a
suitable filename with the current date prepended.</li>
  <li>At line 6 the filename is expanded to a full path to the file to create.</li>
  <li>The following block (8–18) writes a post template to that file. This is
some <abbr title="Yet Another Markup Language">YAML</abbr> front matter, with the <code>published</code> flag down by default.</li>
  <li>Finally, at line 20, it launches the file in my default text editor,
which in my case in <a href="http://macromates.com" title="TextMate is my favourite text editor">TextMate</a>.</li>
</ol><h2 id="draft-posts">Draft posts</h2>

<p>With the <code>published</code> flag set to <code>false</code> <strong>I can keep my drafts in my Git
repository without actually publishing them</strong>. I can find all draft posts
using <code>rake drafts</code>:</p>

<pre><code class="language-ruby">desc <span class="s"><span class="dl">'</span><span class="k">List all draft posts</span><span class="dl">'</span></span>
task <span class="sy">:drafts</span> <span class="r">do</span>
  puts <span class="sh"><span class="dl">`</span><span class="k">find ./_posts -type f -exec grep -H 'published: false' {} </span><span class="ch">\\</span><span class="k">;</span><span class="dl">`</span></span>
<span class="r">end</span></code></pre>

<h2 id="renaming-files">Renaming files</h2>

<p>One slight problem occurs when I want to rename the file to publish it on a
different date. I don’t have a task yet that can easily rename a file. It
would also be useful to be able to override the default extension.</p>

<p>There’s still some work to do, but I guess I’ve got 80% of the scenarios
covered.</p>

            </div><!-- /content -->

            <div id="footer" class="autoclear">

                <form action="http://www.google.com/cse" id="cse-search-box">
                    <div>
                        <label for="google-search-box">Search this site:</label>
                        <input type="hidden" name="cx" value="013424593838246409070:wnaxfzkihdk">
                        <input type="hidden" name="ie" value="UTF-8">
                        <input type="search" name="q" size="31" id="google-search-box">
                        <input type="submit" name="sa" value="Search">
                    </div>
                </form>

                <div class="col">
                    <h6>Find me elsewhere</h6>
                    <ul>
                        <li><a href="http://twitter.com/avdgaag" title="" rel="external me">Twitter</a></li>
                        <li><a href="http://linkedin.com/avdgaag" title="" rel="external me">LinkedIn</a></li>
                        <li><a href="http://github.com/avdgaag" title="" rel="external me">Github</a></li>
                        <li><a href="http://flickr.com/users/arjanvandergaag" title="" rel="external me">Flickr</a></li>
                        <li><a href="http://delicious.com/arjanvandergaag" title="" rel="external me">Delicious</a></li>
                        <li><a href="http://last.fm/user/surtur" title="" rel="external me">Last.fm</a></li>
                    </ul>
                </div>
                <div class="col">
                    <h6>More of my sites</h6>
                    <ul>
                        <li><a href="http://pasttense.nl/" title="" rel="external me">the Past Tense</a></li>
                        <li><a href="http://agwebdesign.nl/" title="" rel="external me">AG Webdesign</a></li>
                        <li><a href="http://yummyinmytummy.nl/" title="" rel="external me">Yummy in my Tummy!</a></li>
                        <li><a href="http://arjanvandergaag.nl/" title="" rel="external me">Arjan van der Gaag.nl</a></li>
                        <li><a href="http://library.arjanvandergaag.nl/" title="" rel="external me">My Library</a></li>
                    </ul>
                </div>

                <p class="col">© copyright 1995&ndash;2010 Arjan van der Gaag unless noted otherwise.</p>

            </div><!-- /footer -->

        </div><!-- /page -->

        <script src="http://www.google.com/jsapi"></script>
        <script>google.load("elements", "1", {packages: "transliteration"});</script>
        <script src="http://www.google.com/coop/cse/t13n?form=cse-search-box&amp;t13n_langs=en"></script>
        <script src="http://www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>

    </body>
</html>